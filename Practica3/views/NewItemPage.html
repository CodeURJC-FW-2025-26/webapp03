<!DOCTYPE html>
<html>

<head>
    <title> Nueva receta </title>
    <!--Bootstrap-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!--CSS Styles-->
    <link type="text/css" rel="stylesheet" href="/Styles.css">
    <!--Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fugaz+One&family=Questrial&display=swap" rel="stylesheet">
    <!--Public app.js-->
    <script src="/app.js"></script>
</head> 

<body>
    
    {{>Header}}

    <div id="page-vars" data-new-item-page="true"></div> <!-- with this app.js can access page variables -->

    <div class="container-fluid text-center">
        <div class="row-1 p-3">
            <h1> Nueva receta </h1>
        </div>

        <!--onsubmit="submitRecipe(event)"-->
        <form id="recipeForm" role="form" method="post" action="{{#isEdit}}/EditItem/{{recipe._id}}{{/isEdit}}{{^isEdit}}NewItem{{/isEdit}}" enctype="multipart/form-data">
            <input type="hidden" name="editForm" id="EditForm" value="{{#isEdit}}true{{/isEdit}}{{^isEdit}}false{{/isEdit}}">
            <div class="form-group">
                <label for="Name"><strong> Nombre: </strong></label>
                <input type="text" name="name" oninput='checkRecipeAvailability()' class="form-control" id="Name" value="{{recipe.name}}" placeholder="Nombre de la receta...">
                <div class="invalid-feedback" id="NameError"></div> <!--error notification-->
            </div>

            <div class="form-group row justify-content-center">
                <label for="Dish"><strong> Tipo de plato: </strong></label>
                <select class="form-select justify-content-center" name="dish" id="Dish">
                    <option value="" disabled selected> Tipo de plato... </option>
                    <option value="Guarnición" {{#isStarter}}selected{{/isStarter}}> Guarnición. </option>
                    <option value="Primer plato" {{#isSide}}selected{{/isSide}}> Primer plato. </option>
                    <option value="Segundo plato" {{#isMain}}selected{{/isMain}}> Segundo plato. </option>
                    <option value="Postre" {{#isDessert}}selected{{/isDessert}}> Postre. </option>
                </select>
                <div class="invalid-feedback" id="DishError"></div> <!--bootstrap style-->
            </div>

            <div class="form-group row justify-content-center">
                <label for="Difficulty"><strong> Dificultad: </strong></label>
                <div class="form-group" id="DifficultyGroup">
                    <label><input type="radio" id="Difficulty" name="difficulty" value="Fácil" {{#isEasy}}checked{{/isEasy}}> Fácil. </label>
                    <label><input type="radio" id="Difficulty" name="difficulty" value="Media" {{#isMedium}}checked{{/isMedium}}> Media. </label>
                    <label><input type="radio" id="Difficulty" name="difficulty" value="Difícil" {{#isHard}}checked{{/isHard}}> Difícil. </label>
                </div>
                <div class="invalid-feedback" id="DifficultyError"></div> <!--bootstrap style-->
            </div>

            <div class="form-group row justify-content-center">
                <label for="Length"><strong> Duración: </strong></label>
                <select class="form-select justify-content-center" name="length" id="Length">
                        <option value="" disabled selected> Duración... </option>
                        <option value="5 min" {{#is5min}}selected{{/is5min}}> 5 min </option>
                        <option value="15 min" {{#is15min}}selected{{/is15min}}> 15 min </option>
                        <option value="30 min" {{#is30min}}selected{{/is30min}}> 30 min </option>
                        <option value="45 min" {{#is45min}}selected{{/is45min}}> 45 min </option>
                        <option value="1 h" {{#is1h}}selected{{/is1h}}> 1 h </option>
                        <option value="2 h" {{#is2h}}selected{{/is2h}}> 2 h </option>
                        <option value="3 h" {{#is3h}}selected{{/is3h}}> 3 h </option>
                        <option value="+3 h" {{#isMore3h}}selected{{/isMore3h}}> +3 h </option>
                </select>
                <div class="invalid-feedback" id="LengthError"></div> <!--bootstrap style-->
            </div>

            <div class="form-group">
                <label for="Description"><strong> Descripción: </strong></label>
                <textarea class="form-control" name="description" id="Description" rows="3"> {{recipe.description}} </textarea>
                <div class="invalid-feedback" id="DescriptionError"></div> <!--bootstrap style-->
            </div>

            <div class="row">
                <label for="Allergens"><strong> Alérgenos: </strong></label>
                <div class="col">
                    <label><input type="checkbox" name="allergens" value="Gluten" {{#gluten}}checked{{/gluten}}> Gluten. </label><br>
                    <label><input type="checkbox" name="allergens" value="Crustáceos" {{#crustacean}}checked{{/crustacean}}> Crustáceos. </label><br>
                    <label><input type="checkbox" name="allergens" value="Huevo" {{#eggs}}checked{{/eggs}}> Huevo. </label><br>
                    <label><input type="checkbox" name="allergens" value="Pescado" {{#fish}}checked{{/fish}}> Pescado. </label><br>
                    <label><input type="checkbox" name="allergens" value="Cacahuetes" {{#peanuts}}checked{{/peanuts}}> Cacahuetes. </label><br>
                    <label><input type="checkbox" name="allergens" value="Soja" {{#soya}}checked{{/soya}}> Soja. </label><br>
                    <label><input type="checkbox" name="allergens" value="Lacteos" {{#dairy}}checked{{/dairy}}> Lacteos. </label><br>
                </div>

                <div class="col">
                    <label><input type="checkbox" name="allergens" value="Frutos con cáscara" {{#nuts}}checked{{/nuts}}> Frutos con cáscara. </label><br>
                    <label><input type="checkbox" name="allergens" value="Apio" {{#celery}}checked{{/celery}}> Apio. </label><br>
                    <label><input type="checkbox" name="allergens" value="Mostaza" {{#mustard}}checked{{/mustard}}> Mostaza. </label><br>
                    <label><input type="checkbox" name="allergens" value="Sésamo" {{#sesame}}checked{{/sesame}}> Sésamo. </label><br>
                    <label><input type="checkbox" name="allergens" value="Sulfitos" {{#sulfites}}checked{{/sulfites}}> Sulfitos. </label><br>
                    <label><input type="checkbox" name="allergens" value="Altramuces" {{#lupin}}checked{{/lupin}}> Altramuces. </label><br>
                    <label><input type="checkbox" name="allergens" value="Moluscos" {{#mollusk}}checked{{/mollusk}}> Moluscos. </label><br>
                </div>
            </div>

            <div class="form-group">
                <label for="Steps"><strong> Pasos de preparacion: </strong></label>
                <textarea class="form-control" name="steps" id="Steps" rows="3"> {{recipe.steps}} </textarea>
                <div class="invalid-feedback" id="StepsError"></div> <!--bootstrap style-->
            </div>

            <div class="form-group">
                <label for="Image"><strong> Imagen: {{#isEdit}} (opcional, si no se incluye o se selecciona una distinta se eliminará la anterior) {{/isEdit}} </strong></label>
                <input class="form-control" onchange="previewImage(event)" name="image" id="Image" type="file" accept="image/*">
                <div id="DropArea"style="{{#recipe.image}}display:none;{{/recipe.image}}{{^recipe.image}}display:block;{{/recipe.image}}">Arrastra la imagen aqui</div>
                <div id="ImagePreview">{{#recipe.image}}<img src="/recipe/{{recipe._id}}/image" class="img-thumbnail" style="max-width:200px;">{{/recipe.image}}</div>
                <button type="button" onclick="DeleteImage()" class="btn btn-primary mx-auto mt-3" id="ImageButton"style="{{#recipe.image}}display:block;{{/recipe.image}}{{^recipe.image}}display:none;{{/recipe.image}}"><i class="bi bi-trash"></i> Eliminar la imagen seleccionada </button>
                <input type="hidden" name="deleteImage" id="EditDeleteImage" value="false">
                <div class="invalid-feedback" id="ImageError"></div> <!--bootstrap style-->
            </div>

            <div class="form-group mb-0">
                <button type="submit" class="btn btn-primary"> <i class="bi bi-floppy"></i> Guardar </button> 
                <a href="/MainPage.html/1" class="btn btn-primary" role="button"> <i class="bi bi-box-arrow-left"></i> Cancelar </a>
            </div>

            <div class="modal fade" id="AlertContainer" tabindex="-1" role="dialog"></div>
        </form>
        
        <!--Spinner-->
        <div id="Spinner" class="spinner-border text-primary" role="status" style="display:none;">
            <span class="visually-hidden">Procesando...</span>
        </div>
    </div>

    {{>Footer}}

</body>
</html>
